<h2><a href=https://www.codewars.com/kata/52dd912cf5073adca8000556/train/javascript target="_blank">A Banking Trouble</a></h2><h3>5 kyu</h3><p>You are making an online banking product, which can be used by thirdparty software (such as desktop or browser clients) to process financial operations. Your external API has an <code>Account</code> class to symbolize user accounts, and it looks as follows: </p><pre><code class="language-javascript"><span class="cm-keyword">function</span> <span class="cm-def">Account</span>(<span class="cm-def">name</span>) {    <span class="cm-keyword">this</span>.<span class="cm-property">owner</span> <span class="cm-operator">=</span> <span class="cm-variable-2">name</span>;}<span class="cm-variable">Account</span>.<span class="cm-property">prototype</span>.<span class="cm-property">deposit</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> (<span class="cm-def">amount</span>) {    <span class="cm-keyword">return</span> <span class="cm-string">'Deposited '</span> <span class="cm-operator">+</span> <span class="cm-variable-2">amount</span> <span class="cm-operator">+</span> <span class="cm-string">'$ to '</span> <span class="cm-operator">+</span> <span class="cm-keyword">this</span>.<span class="cm-property">owner</span> <span class="cm-operator">+</span> <span class="cm-string">'\'s account'</span>;}</code></pre><p>Your product also utilizes an external gateway to securely process operations, and all was going well - until today. A hail of calls from the people whose money did not reach their accounts had hit your tech support. You contacted the gateway immediately, and they confirmed that there was a hackers' attack, but they still can't manage to cope with it. Finally, you've convinced them to send you a piece of gateway's own code - in hope that you can find and compensate its weak points.</p><p>What you received was:</p><pre><code class="language-javascript"><span class="cm-keyword">var</span> <span class="cm-def">Gateway</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> () {  <span class="cm-comment">//...</span>  <span class="cm-comment">// proprietary code</span>  <span class="cm-comment">//...</span>}<span class="cm-variable">Gateway</span>.<span class="cm-property">prototype</span>.<span class="cm-property">doOperation</span> <span class="cm-operator">=</span> <span class="cm-keyword">function</span> (<span class="cm-def">amount</span>, <span class="cm-def">operation</span>) {  <span class="cm-comment">//...</span>  <span class="cm-comment">// proprietary journaling code</span>  <span class="cm-comment">//...</span>  <span class="cm-keyword">return</span> <span class="cm-variable-2">operation</span>(<span class="cm-variable-2">amount</span>);}</code></pre><p>Not much (or nearly as secure, as a gateway code should have been) - but you have to play the hand you are dealt.</p><p>So now you have</p><ul><li>a piece of gateway that you cannot modify</li><li>an external API, which can be updated - but it will take days for all thirdparty clients to switch to the new version</li><li>your own code on your own servers which you contol and can change and deploy very fast</li></ul><p>And that leaves you with only one option - your task is to protect your transactions from the hacker by modifying only your own code.</p>